<%
  unless defined? stored_filters
    stored_filters = true
  end
%>

  <div
  data-controller="refine--search-filter"
   data-refine--search-filter-search-frame-id-value="index_search"
   data-refine--search-filter-submit-url-value="<%= hammerstone_refine_blueprint_path %>"
   data-action="filter-submit-success@document->refine--search-filter#loadResults"
  >

  <%= tag.div class: "refine-filter-builder-dropdown-container", data: {
    controller: "reveal"
  } do %>
    <button
      class="refine-filter-condition-toggle-button"
      data-action="reveal#toggle"
      type="button"
    >
      + Add Filter
    </button>
    <div
      hidden
      data-reveal
      data-transition
      data-transition-enter="transition ease-out duration-100"
      data-transition-enter-start="transform opacity-0 scale-95"
      data-transition-enter-end="transform opacity-100 scale-100"
      data-transition-leave="transition ease-in duration-75"
      data-transition-leave-start="transform opacity-100 scale-100"
      data-transition-leave-end="transform opacity-0 scale-95"
      data-controller="filter-link"

      class="refine-filter-builder-dropdown-search-box"
      style="min-width: 50vw; max-height: 66vh; overflow: auto;"
    >
      <%= turbo_frame_tag :refine_filter_modal, loading: :lazy,
        src: hammerstone_refine_conditions_path(hammerstone_refine_filters_builder: {filter_class: @refine_filter.class.name}) do %>

      <% end %>
  <% end %>

</div>
