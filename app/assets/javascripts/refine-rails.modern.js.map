{"version":3,"file":"refine-rails.modern.js","sources":["../../../node_modules/@stimulus/webpack-helpers/dist/index.js","../../javascript/controllers/refine/form-controller.js","../../javascript/controllers/refine/add-controller.js","../../javascript/controllers/refine/defaults-controller.js","../../javascript/controllers/refine/delete-controller.js","../../javascript/refine/helpers/index.js","../../javascript/controllers/refine/state-controller.js","../../javascript/controllers/refine/stored-filter-controller.js","../../javascript/controllers/refine/update-controller.js","../../javascript/controllers/index.js"],"sourcesContent":["export function definitionsFromContext(context) {\n    return context.keys()\n        .map(function (key) { return definitionForModuleWithContextAndKey(context, key); })\n        .filter(function (value) { return value; });\n}\nfunction definitionForModuleWithContextAndKey(context, key) {\n    var identifier = identifierForContextKey(key);\n    if (identifier) {\n        return definitionForModuleAndIdentifier(context(key), identifier);\n    }\n}\nfunction definitionForModuleAndIdentifier(module, identifier) {\n    var controllerConstructor = module.default;\n    if (typeof controllerConstructor == \"function\") {\n        return { identifier: identifier, controllerConstructor: controllerConstructor };\n    }\n}\nexport function identifierForContextKey(key) {\n    var logicalName = (key.match(/^(?:\\.\\/)?(.+)(?:[_-]controller\\..+?)$/) || [])[1];\n    if (logicalName) {\n        return logicalName.replace(/_/g, \"-\").replace(/\\//g, \"--\");\n    }\n}\n//# sourceMappingURL=index.js.map","import { Controller } from 'stimulus'\n\nexport default class extends Controller {\n  connect() {\n    const refineElement = document.getElementById('hammerstone_refine_query')\n\n    this.state = this.application.getControllerForElementAndIdentifier(refineElement, 'refine--state')\n    this.blueprintInput = this.addHiddenInput('blueprint')\n    this.addHiddenInput('filter', this.state.filterName)\n    this.finishUpdate()\n  }\n\n  addHiddenInput(name, initialValue) {\n    const input = document.createElement('input')\n    input.type = 'hidden'\n    input.name = name\n    input.value = initialValue || ''\n    this.element.appendChild(input)\n    return input\n  }\n\n  // called on connect\n  finishUpdate() {\n    this.state.finishUpdate()\n  }\n\n  // Call this on submit\n  startUpdate() {\n    this.blueprintInput.value = JSON.stringify(this.state.blueprint)\n    this.state.startUpdate()\n  }\n\n  submitForm() {\n    this.startUpdate()\n    this.element.requestSubmit()\n  }\n}\n","import FormController from './form-controller'\n\nexport default class extends FormController {\n  static values = {\n    previousCriterionId: Number,\n  }\n\n  criterion() {\n    this.state.addCriterion(this.previousCriterionIdValue)\n    this.startUpdate()\n  }\n\n  group() {\n    this.state.addGroup()\n    this.startUpdate()\n  }\n}\n","import { Controller } from \"stimulus\";\n\nexport default class extends Controller {\n  static values = {\n    criterionId: Number,\n    input: Object,\n  };\n\n  connect() {\n    const refineElement = document.getElementById('refine');\n\n    this.state = this.application.getControllerForElementAndIdentifier(\n      refineElement,\n      'refine--state',\n    );\n\n    this.state.updateInput(\n      this.criterionIdValue,\n      this.inputValue,\n    );\n  }\n}\n","import FormController from './form-controller';\n\nexport default class extends FormController {\n  static values = {\n    criterionId: Number,\n  }\n\n  criterion() {\n    const { state, criterionIdValue } = this;\n    state.deleteCriterion(criterionIdValue);\n    this.startUpdate();\n  }\n}\n","// Polyfill for custom events in IE9-11\n// https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#polyfill\n;(function () {\n  if (typeof window.CustomEvent === 'function') return false\n\n  function CustomEvent(event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: undefined }\n    var evt = document.createEvent('CustomEvent')\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail)\n    return evt\n  }\n\n  CustomEvent.prototype = window.Event.prototype\n\n  window.CustomEvent = CustomEvent\n\n  // eslint expects a return here\n  return true\n})()\n\nexport const filterStabilizedEvent = (element, stableId, filterName, initialLoad) => {\n  const event = new CustomEvent('filter-stabilized', {\n    bubbles: true,\n    cancelable: true,\n    detail: {\n      stableId,\n      filterName,\n      initialLoad,\n    },\n  })\n  element.dispatchEvent(event)\n}\n\nexport const filterUnstableEvent = (blueprint) => {\n  const event = new CustomEvent('filter-unstable', {\n    detail: {\n      blueprint,\n    },\n  })\n  window.dispatchEvent(event)\n}\n\nexport const filterStoredEvent = (storedFilterId) => {\n  const event = new CustomEvent('filter-stored', {\n    detail: {\n      storedFilterId,\n    },\n  })\n  window.dispatchEvent(event)\n}\n","import { Controller } from 'stimulus'\nimport { delegate, abnegate } from 'jquery-events-to-dom-events'\nimport { filterUnstableEvent, filterStabilizedEvent } from '../../refine/helpers'\n\nconst criterion = (id, depth, condition) => {\n  const { meta, refinements, component } = condition\n  const { clauses, options } = meta\n  const isOptionCondition = component === 'option-condition'\n  // Set newInput based on component\n\n  let newInput = {\n    clause: clauses[0].id,\n    selected: isOptionCondition ? [options[0].id] : undefined,\n  }\n\n  // If refinements are present, add to input array\n  refinements.forEach((refinement) => {\n    const { meta, component } = refinement\n    const { clauses, options } = meta\n    const isOptionCondition = component === 'option-condition'\n    newInput[refinement.id] = {\n      clause: clauses[0].id,\n      selected: isOptionCondition ? [options[0].id] : undefined,\n    }\n  })\n\n  return {\n    depth,\n    type: 'criterion',\n    condition_id: id,\n    input: newInput,\n  }\n}\n\nconst or = function (depth) {\n  depth = depth === undefined ? 0 : depth\n  return {\n    depth,\n    type: 'conjunction',\n    word: 'or',\n  }\n}\n\nconst and = function (depth) {\n  depth = depth === undefined ? 1 : depth\n  return {\n    depth,\n    type: 'conjunction',\n    word: 'and',\n  }\n}\n\nexport default class extends Controller {\n  static values = {\n    blueprint: Array,\n    conditions: Array,\n    className: String,\n    stableId: String,\n  }\n  static targets = ['loading']\n\n  connect() {\n    // for select2 jquery events and datepicker\n    this.changeDelegate = delegate('change', ['event', 'picker'])\n    this.blueprint = this.blueprintValue\n    this.conditions = this.conditionsValue\n    this.filterName = this.classNameValue\n    this.stableId = this.stableIdValue\n    this.conditionsLookup = this.conditions.reduce((lookup, condition) => {\n      lookup[condition.id] = condition\n      return lookup\n    }, {})\n    this.loadingTimeout = null\n\n    filterStabilizedEvent(this.element, this.stableId, this.filterName, true)\n    filterStabilizedEvent(window, this.stableId, this.filterName, true)\n  }\n\n  disconnect() {\n    abnegate('change', this.changeDelegate)\n  }\n\n  startUpdate() {\n    if (this.loadingTimeout) {\n      window.clearTimeout(this.loadingTimeout)\n    }\n    // only show the loading overlay if it's taking a long time\n    // to render the updates\n    this.loadingTimeout = window.setTimeout(() => {\n      document.activeElement.blur()\n      this.loadingTarget.classList.remove('hidden')\n    }, 1000)\n  }\n\n  finishUpdate() {\n    if (this.loadingTimeout) {\n      window.clearTimeout(this.loadingTimeout)\n    }\n    this.loadingTarget.classList.add('hidden')\n  }\n\n  conditionConfigFor(conditionId) {\n    return this.conditionsLookup[conditionId]\n  }\n\n  updateStableId(newUrl) {\n    if (newUrl !== this.stableId) {\n      this.stableId = newUrl\n      filterStabilizedEvent(this.element, this.stableId, this.filterName)\n      filterStabilizedEvent(window, this.stableId, this.filterName)\n    }\n  }\n\n  addGroup() {\n    const { blueprint, conditions } = this\n    const condition = conditions[0]\n    const { meta } = condition\n\n    if (this.blueprint.length > 0) {\n      this.blueprint.push(or())\n    }\n    this.blueprint.push(criterion(condition.id, 1, condition))\n    filterUnstableEvent(this.blueprint)\n  }\n\n  addCriterion(previousCriterionId) {\n    const { blueprint, conditions } = this\n    const condition = conditions[0]\n    const { meta } = condition\n    blueprint.splice(previousCriterionId + 1, 0, and(), criterion(condition.id, 1, condition))\n    filterUnstableEvent(this.blueprint)\n  }\n\n  deleteCriterion(criterionId) {\n    /**\n       To support 'groups' there is some complicated logic for deleting criterion.\n\n       Imagine this simplified blueprint: [eq, and, sw, or, eq]\n\n       User clicks to delete the last eq. We also have to delete the preceding or\n       otherwise we're left with a hanging empty group\n\n       What if the user deletes the sw? We have to clean up the preceding and.\n\n       Imagine another scenario: [eq or sw and ew]\n       Now we delete the first eq but this time we need to clean up the or.\n\n       These conditionals cover these cases.\n    **/\n    const { blueprint } = this\n    const previous = blueprint[criterionId - 1]\n    const next = blueprint[criterionId + 1]\n\n    const nextIsOr = next && next.word === 'or'\n    const previousIsOr = previous && previous.word === 'or'\n\n    const nextIsRightParen = nextIsOr || !next\n    const previousIsLeftParen = previousIsOr || !previous\n\n    const isFirstInGroup = previousIsLeftParen && !nextIsRightParen\n    const isLastInGroup = previousIsLeftParen && nextIsRightParen\n    const isLastCriterion = !previous && !next\n\n    if (isLastCriterion) {\n      this.blueprint = []\n    } else if (isLastInGroup && previousIsOr) {\n      blueprint.splice(criterionId - 1, 2)\n    } else if (isLastInGroup && !previous) {\n      blueprint.splice(criterionId, 2)\n    } else if (isFirstInGroup) {\n      blueprint.splice(criterionId, 2)\n    } else {\n      blueprint.splice(criterionId - 1, 2)\n    }\n\n    /**\n     * Blueprints always have an initial value so we don't have\n     * an awkward empty state in the UI\n     */\n    if (this.blueprint.length === 0) {\n      const condition = this.conditions[0]\n      const { meta } = condition\n\n      this.blueprint.push(criterion(condition.id, 1, condition))\n    }\n\n    filterUnstableEvent(this.blueprint)\n  }\n\n  replaceCriterion(criterionId, conditionId, condition) {\n    const criterionRow = this.blueprint[criterionId]\n    if (criterionRow.type !== 'criterion') {\n      throw new Error(\n        `You can't call updateConditionId on a non-criterion type. Trying to update ${JSON.stringify(criterion)}`\n      )\n    }\n    // Build out a default criterion.\n    this.blueprint[criterionId] = criterion(conditionId, criterionRow.depth, condition)\n    filterUnstableEvent(this.blueprint)\n  }\n\n  updateInput(criterionId, input, inputId) {\n    // Input id is an array of hash keys that define the path for this input such as [\"input\", \"date_refinement\"]\n    const { blueprint } = this\n    const criterion = blueprint[criterionId]\n    inputId = inputId || 'input'\n    const blueprintPath = inputId.split(', ')\n    // If the inputId contains more than one element, add input at appropriate depth\n    if (blueprintPath.length > 1) {\n      criterion[blueprintPath[0]][blueprintPath[1]] = { ...criterion[blueprintPath[0]][blueprintPath[1]], ...input }\n    } else {\n      criterion[inputId] = { ...criterion[inputId], ...input }\n    }\n    filterUnstableEvent(this.blueprint)\n  }\n}\n","import { Controller } from 'stimulus'\nimport { filterStoredEvent } from '../../refine/helpers'\n\nexport default class extends Controller {\n  static targets = ['enabledSaveLink', 'disabledSaveLink', 'stableIdField']\n  static values = { id: Number, stableId: String }\n\n  connect() {\n    if (this.idValue) {\n      filterStoredEvent(this.idValue)\n    }\n  }\n\n  updateStableIdField(event) {\n    if (this.hasStableIdFieldTarget) {\n      const { detail } = event\n      const { stableId } = detail\n      this.stableIdFieldTarget.value = stableId\n    }\n  }\n\n  activateSaveLink(event) {\n    const { detail } = event\n    const { stableId, initialLoad } = detail\n\n    // Don't bubble the filterStabilized event if\n    // it's not different\n    if (stableId == this.stableIdValue) {\n      event.preventDefault()\n      event.stopPropagation()\n    }\n    if (this.hasEnabledSaveLinkTarget && this.hasDisabledSaveLinkTarget && !initialLoad) {\n      const saveUrl = new URL(this.enabledSaveLinkTarget.href)\n      saveUrl.searchParams.set('stable_id', stableId)\n      this.enabledSaveLinkTarget.setAttribute('href', saveUrl)\n      this.disabledSaveLinkTarget.classList.add('hidden')\n      this.enabledSaveLinkTarget.classList.remove('hidden')\n    }\n  }\n}\n","import FormController from './form-controller'\nimport { debounce } from 'lodash'\n\nexport default class extends FormController {\n  static values = {\n    criterionId: Number,\n    stableId: String,\n  }\n\n  initialize() {\n    this.updateBlueprint = debounce((event, value, inputKey) => {\n      this.value(event, value, inputKey)\n      this.createStableId(this.state.blueprint, this.state.filterName)\n    }, 500)\n  }\n\n  connect() {\n    FormController.prototype.connect.apply(this)\n    this.state.updateStableId(this.stableIdValue)\n  }\n\n  refinedFilter(event) {\n    const { criterionIdValue, state } = this\n    const dataset = event.target.dataset\n    const inputId = dataset.inputId\n\n    state.updateInput(\n      criterionIdValue,\n      {\n        id: event.target.value,\n      },\n      inputId\n    )\n    this.submitForm()\n  }\n\n  clause(event) {\n    const { criterionIdValue, state } = this\n    const dataset = event.target.dataset\n    const inputId = dataset.inputId\n    state.updateInput(\n      criterionIdValue,\n      {\n        clause: event.target.value,\n      },\n      inputId\n    )\n    this.submitForm()\n  }\n\n  selected(event) {\n    const { target: select } = event\n    const options = Array.prototype.slice.call(select.options)\n    const selectedOptions = options.filter((option) => option.selected)\n    const selected = selectedOptions.map((option) => option.value)\n    this.value(event, selected, 'selected')\n    this.createStableId(this.state.blueprint, this.state.filterName)\n  }\n\n  value(event, value, inputKey) {\n    const { criterionIdValue, state } = this\n    const dataset = event.target.dataset\n    const inputId = dataset.inputId\n    inputKey = inputKey || dataset.inputKey || 'value'\n    value = value || event.target.value\n    state.updateInput(\n      criterionIdValue,\n      {\n        [inputKey]: value,\n      },\n      inputId\n    )\n  }\n\n  date(event) {\n    const { picker } = event.detail\n    const value = picker.startDate.format('YYYY-MM-DD')\n    this.value(event, value)\n    this.submitForm()\n  }\n\n  createStableId(blueprint, filter) {\n    // Create stableId on debounced input and update stable id to allow for form submission\n    const { state } = this\n    let post_data = JSON.stringify({ blueprint, filter })\n    let token = document.querySelector(\"meta[name='csrf-token']\").content\n    $.ajax({\n      type: 'PUT',\n      url: '/hammerstone/update_stable_id',\n      data: post_data,\n      headers: {\n        accept: 'application/json',\n        'content-type': 'application/json',\n        'X-CSRF-Token': token,\n      },\n      success: function (e) {\n        state.updateStableId(e.filter_id)\n      },\n    })\n  }\n\n  condition(event) {\n    const { criterionIdValue, state } = this\n    const element = event.target\n    const newConditionId = element.value\n    const config = this.state.conditionConfigFor(newConditionId)\n    state.replaceCriterion(criterionIdValue, newConditionId, config)\n    this.submitForm()\n  }\n}\n","import { identifierForContextKey } from \"@stimulus/webpack-helpers\"\n\nimport AddController from './refine/add-controller'\nimport DefaultsController from './refine/defaults-controller'\nimport DeleteController from './refine/delete-controller'\nimport FormController from './refine/form-controller'\nimport StateController from './refine/state-controller'\nimport StoredFilterController from './refine/stored-filter-controller'\nimport UpdateController from './refine/update-controller'\n\nexport const controllerDefinitions = [\n  [AddController, 'refine/add-controller.js'],\n  [DefaultsController, 'refine/defaults-controller.js'],\n  [DeleteController, 'refine/refine/delete-controller.js'],\n  [FormController, 'refine/refine/form-controller'],\n  [StateController, 'refine/state-controller.js'],\n  [StoredFilterController, 'refine/stored-filter-controller.js'],\n  [UpdateController, 'refine/update-controller.js']\n].map(function(d) {\n  const key = d[1]\n  const controller = d[0]\n  return {\n    identifier: identifierForContextKey(key),\n    controllerConstructor: controller\n  }\n})\n\nexport {\n  AddController,\n  DefaultsController,\n  DeleteController,\n  FormController,\n  StateController,\n  StoredFilterController,\n  UpdateController\n}"],"names":["identifierForContextKey","key","logicalName","match","replace","Controller","connect","refineElement","document","getElementById","this","state","application","getControllerForElementAndIdentifier","blueprintInput","addHiddenInput","filterName","finishUpdate","name","initialValue","input","createElement","type","value","element","appendChild","startUpdate","JSON","stringify","blueprint","submitForm","requestSubmit","_class","FormController","criterion","addCriterion","previousCriterionIdValue","group","addGroup","values","previousCriterionId","Number","updateInput","criterionIdValue","inputValue","criterionId","Object","deleteCriterion","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","prototype","Event","filterStabilizedEvent","stableId","initialLoad","dispatchEvent","filterUnstableEvent","id","depth","condition","meta","refinements","component","clauses","options","newInput","clause","selected","forEach","refinement","condition_id","changeDelegate","delegate","blueprintValue","conditions","conditionsValue","classNameValue","stableIdValue","conditionsLookup","reduce","lookup","loadingTimeout","disconnect","abnegate","clearTimeout","setTimeout","activeElement","blur","loadingTarget","classList","remove","add","conditionConfigFor","conditionId","updateStableId","newUrl","length","push","word","splice","previous","next","previousIsOr","nextIsRightParen","previousIsLeftParen","isLastInGroup","replaceCriterion","criterionRow","Error","inputId","blueprintPath","split","_extends","Array","className","String","targets","idValue","storedFilterId","filterStoredEvent","updateStableIdField","hasStableIdFieldTarget","stableIdFieldTarget","activateSaveLink","preventDefault","stopPropagation","hasEnabledSaveLinkTarget","hasDisabledSaveLinkTarget","saveUrl","URL","enabledSaveLinkTarget","href","searchParams","set","setAttribute","disabledSaveLinkTarget","initialize","updateBlueprint","debounce","inputKey","createStableId","apply","refinedFilter","target","dataset","select","slice","call","filter","option","map","date","picker","startDate","format","post_data","token","querySelector","content","$","ajax","url","data","headers","accept","success","e","filter_id","newConditionId","config","controllerDefinitions","AddController","DefaultsController","DeleteController","StateController","StoredFilterController","UpdateController","d","controller","identifier","controllerConstructor"],"mappings":"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"}